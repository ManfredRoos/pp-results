
Biojs.PDBprints=Biojs.extend({opt:{target:"YourOwnDivId",rapha:null,pdbids:['2x9t']},constructor:function(options){var self=this;var defconf={size:40,orient:'h',interval:10,startX:10,startY:10};var deldiv=[];for(var ci=0;ci<self.opt.targets.length;ci++){var config=self.opt.targets[ci];for(var akey in defconf){if(!config[akey])config[akey]=defconf[akey];}
if(!config['rapha']){var sizex=config.startX+config.size*8;var sizey=config.startY+(config.interval+config.size)*config.pdbids.length;if(config.orient=="v"){sizey=config.startY+config.size*8;sizex=config.startX+(config.interval+config.size)*config.pdbids.length;}
config['rapha']=Raphael(config['divid'],sizex,sizey);}}
var pdbids='';for(var rapha in self.opt.targets){for(var pi=0;pi<self.opt.targets[rapha]['pdbids'].length;pi++)
pdbids+=self.opt.targets[rapha]['pdbids'][pi]+",";}
pdbids=pdbids.replace(/,$/,"");jQuery.ajax({url:'http://www.ebi.ac.uk/pdbe-apps/widgets/pdbprints',data:{'varname':'printsdata','pdbid':pdbids},dataType:'script',crossDomain:'true',type:'GET',success:function(response,callOptions){self.printsLayout(printsdata);}});},printsLayout:function(printsdata){var self=this;for(var ci=0;ci<self.opt.targets.length;ci++){var config=self.opt.targets[ci];self.printsLayout1(config,printsdata)}},printsLayout1:function(conf,printsdata){var self=this;var printsize=50,printsorient='h',printstartX=10,printstartY=10,printsInterval=5;printsize=conf.size;printsorient=conf.orient;printsInterval=conf.interval;printstartX=conf.startX;printstartY=conf.startY;var printscats=["PDBeLogo","PrimaryCitation","Taxonomy","Expressed","Experimental","Protein","NucleicAcid","Ligands"];var catsinfo={"PDBeLogo":[""],"PrimaryCitation":["citation"],"Taxonomy":["taxonomy"],"Expressed":["taxonomy"],"Experimental":["experimental"],"Protein":["primary"],"NucleicAcid":["primary"],"Ligands":["ligands"]};for(var pi=0;pi<conf['pdbids'].length;pi++){var pid=conf['pdbids'][pi];for(var ci=0;ci<printscats.length;ci++){var cat=printscats[ci];var ix=printstartX+printsize*ci;var iy=printstartY;if(printsorient=='v'){ix=printstartX;iy=printstartY+printsize*ci;}
var imgurl=printsdata[pid][cat][0],isizeY=printsize,isizeX=printsize;var printsURL="http://pdbe.org";if(cat=="PDBeLogo"){var pidlink=conf.rapha.text(ix,iy+printsize/4,pid).attr({'font-family':'Mono','text-anchor':'start','font-size':printsize/3}).attr({'cursor':'pointer','title':'a tooltip '+pid}).data("pdbid",pid);pidlink.mouseup(function(){window.open("http://pdbe.org/"+this.data("pdbid"));});imgurl="http://www.ebi.ac.uk/pdbe-apps/widgets/html/PDBeWatermark_horizontal_128.png";isizeX=printsize*0.9;isizeY=printsize/2;iy+=printsize/2;}
else printsURL+="/"+pid+"/"+catsinfo[cat][0];var printsLogo=conf.rapha.image(imgurl,ix,iy,isizeX,isizeY).attr({'cursor':'pointer','title':'a tooltip '+cat});printsLogo.data("printsURL",printsURL);printsLogo.mouseup(function(){window.open(this.data("printsURL"));});printsLogo.mouseover(function(){});}
if(printsorient=='v')printstartX+=printsize+printsInterval;if(printsorient=='h')printstartY+=printsize+printsInterval;}},eventTypes:["onClick","onHelloSelected"]});