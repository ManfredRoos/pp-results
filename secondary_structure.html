<html lang="en">
	<head>
		<meta charset="utf-8">
		<style type="text/css">	
			.axis path,
			.axis line {
				fill: none;
				stroke: black;
				shape-rendering: crispEdges;
			}
			
			.axis text {
				font-family: sans-serif;
				font-size: 11px;
			}

			#prof-text-div, #prof-html-div{
				display: none;
			}

			.active-content{
				display: block;
			}
			.inactive-content{
				display: none;
			}

		</style>
	<script type="text/javascript" src="../javascript/d3/d3.v3.min.js"></script>
	<script>
	$('#prof-visual').click(function(){
		$(".active").removeClass('active');
		$(this).parent().addClass('active');
		$('#prof-html-div').hide();
		$('#prof-text-div').hide();
		$('#prof-visual-div').show();
	});


	$('#prof-html').click(function(){
		$(".active").removeClass('active');
		$(this).parent().addClass('active');
		$('.active-content').removeClass('active-content').addClass('inactive-content');
		$('#prof-html-div').load('html_source/source4.html #prof-content',  function(response, status, xhr) {
		  	if (status == "error") {
		  		alert (xhr.status)
		    	var msg = "Sorry but there was an error: ";
		    	$("#error").html(msg + xhr.status + " " + xhr.statusText);
		  	}
		  	$('#prof-text-div').hide();
			$('#prof-visual-div').hide();
			$(this).show();
		});
	});


	$('#prof-text').click(function(){
		$(".active").removeClass('active');
		$(this).parent().addClass('active');
		$.get('data/raw/query.phdRdb', function(data) {
			$('#prof-text-div').html('<pre>'+data+'</pre>').addClass('active-content');
			$('#prof-text-div').show();
			$('#prof-visual-div').hide();
			$('#prof-html-div').hide();
		});
	});
	</script>
		
</head>
<body>

<ul class="nav nav-tabs">
<li class="active"> <a id='prof-visual' href="#">Visual</a>  </li>
<li>   <a id='prof-text' href="#">Text</a> </li>
<li>   <a id='prof-html' href="#">Old Format</a> </li> 
</ul>

<div id='prof-visual-div'>
	<div id="FeatureMap" ></div><br>
	<div id='RI_S'></div>
	<p>Overall reliability of secondary structure prediction , 0-9</p>
	<div id='pH'></div>
	<p>Probablity for assigning helix (1=high, 0=low)</p>
	<div id='pE'></div>
	<p>Probablity for assigning strand (1=high, 0=low)</p>
	<div id='pL'></div>
	<p>Probablity for assigning neither helix, nor strand (1=high, 0=low)</p>
</div>
<div id='prof-text-div'></div>
<div id='prof-html-div'></div>

<script>
function createBarChart(dataset,y_index,target_div,color){
	//Create SVG element
	var svg = d3.select('#'+target_div)
			.append("svg")
			.attr("width", w)
			.attr("height", h);


	var xScale = d3.scale.linear()
						 .domain([0, d3.max(dataset, function(d) { return d[0]; })])
						 .range([padding, w - padding * 2]);

	var yScale = d3.scale.linear()
	 					 .domain([0, d3.max(dataset, function(d) { return d[y_index]; })])
	 					 .range([h - padding, padding]);

	//Define X axis
	var xAxis = d3.svg.axis()
					  .scale(xScale)
					  .orient("bottom")
					  .ticks(5);

	//Define Y axis
	var yAxis = d3.svg.axis()
					  .scale(yScale)
					  .orient("left")
					  .ticks(5);

	svg.selectAll("rect")
	   .data(dataset)
	   .enter()
	   .append("rect")
	   .attr("x", function(d, i) {
	   	 return i * (w / dataset.length);
		})
	   .attr("y", function(d) {
	   	 return h - d[y_index]*20;  //Height minus data value
		})
	   .attr("width", w / dataset.length - barPadding)
	   .attr("height", function(d) {
	    	return d[y_index]*20;  //Just the data value
	    })
	    .attr("fill", function(d) { return color;});

	//Create X axis
	svg.append("g")
		.attr("class", "axis")
		.attr("transform", "translate(0," + (h - padding) + ")")
		.call(xAxis);
		
	//Create Y axis
	svg.append("g")
		.attr("class", "axis")
		.attr("transform", "translate(" + padding + ",0)")
		.call(yAxis);

}


var margin = {top: 20, right: 10, bottom: 20, left: 50};

var w = 1000 - margin.left - margin.right;
var h = 300 - margin.top - margin.bottom;

var padding = 0;
var barPadding = 1;  
var parsedRows;
d3.text("data/prof_data.tsv", function(datasetText) {
	parsedRows = d3.tsv.parseRows(datasetText);
	parsedRows.shift();
	console.log(parsedRows);
	createBarChart(parsedRows,4,'RI_S','grey');
	createBarChart(parsedRows,10,'pH','red');
	createBarChart(parsedRows,11,'pE','blue');
	createBarChart(parsedRows,12,'pL','green');
});

// drawFeatureMap('FeatureMap');




</script>
	


</body>
</html>